language: minimal
sudo: required
services:
  - docker

git:
  depth: 2

env:
  - GHC_VER: 8.6.2
  - GHC_VER: 8.4.4
  - GHC_VER: 8.2.2
  - GHC_VER: 8.0.2
  - GHC_VER: 7.10.3
  - GHC_VER: 7.8.4
# NOTE: For GHC head, one needs to build hlint, pier with another compiler version.

install:
  - docker --version

script:
  - docker build . -f Dockerfile --build-arg GHC_VER=${GHC_VER} --tag migamake/haskell-build:${GHC_VER} || exit 1;
  - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
  - docker push migamake/haskell-build:${GHC_VER};
